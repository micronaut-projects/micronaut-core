dist: trusty
addons:
  chrome: stable
language: java
jdk:
- oraclejdk8
sudo: required
services:
- docker
env:
  global:
  - TERM=dumb
  - MALLOC_ARENA_MAX=1
  - GRADLE_OPTS="-Xmx768m -Xms256m -XX:MaxPermSize=372m -XX:+CMSClassUnloadingEnabled"
  - GIT_NAME="Graeme Rocher"
  - GIT_EMAIL="graeme.rocher@gmail.com"
  - secure: W08aMUtRD+SUWY0Xe4t9Jhv+uVS3CDSpQuNn63fylR0bCKBnRI8TJWzSm5oTWH1EuIrFP9H8D0lY7UlzzNaemwFPOZ+YXmNnYqTlJ1P6eRyIGSQ6TpS1wJsMx0EzTeeTx+TpPQ4cmcvQlHQC9ZJS7knAP2/k6IY9cbuo90JHXgmPHAwWvIOwJvHo5dqPCyhqLkWvkEtQmywe73C/e921uLgE120que7nzq5z+njad7FNa1Kr36eYjMwjUybouE2tEOgQ0bEBhM6cJDPI1EKN0n9cnJs98rhLRFY00b7OUKl1HmGOl6RB8WW4OuJu6JNsrSJBl3019yamnmpkK4sI+O3ZEicS1z2iG7w1gSjG8rYr1srhBdxHCHJzx9Kw9pdJCOaTVyQvCdXTjbdEjMeMI1BvhUdY5zkWlasiWGBBif8QwaeUsyj+Hh9nE6OZQQ/gywrqVzLJ8SsHKx3jJ0O6e5kZwwllvo74e05SIQg2Coe/bS60jzKvG0jak///GGRWnIOHeumofqwywUzP4uJle6xWYzpheJNbN/w92jaAJovsg9o87AixS/sJ8zvLmrx42uBQHudDytSxQZCzVxW2UQZXknB/omTzEWPy1PaxwyLsQEutE5npvXETNnOVu/ynEyLQb1wPHCfzmi+nN4vxcukXPU0tdAujySa2TDtB6wQ=
  - secure: fSlvGAWevCRxefJG6im2rZ3B4B3xfNnOQ/8QlEbLoBVxvAuhJkojeo0E4ITXrXw0kajfFYEDbJHml2ROMNeBivzAsFov6mjAYkWD29l1/SxcDOSNegcRy6PkKADbBHDmifklC04RJIBeT/K/AoripSXDirZkiQeLfwvERc/j9iFAcw8wW7oEeKec8duOAjHRSZIFhUIUV5lkGwtNVCTL4bKytu2UbTnVvB6hwPr2eFI+8gnz7nslMU0NzHc9Z7Hh8ztH5Xun5soy6La+jX/LQeJuCuWppAM35W44Sx6jbaqFywjcUJ4RP/xWtrHe6IouNGdD2+KYzHAEIwuPjuUdzwCVzIBfqtoaCyykNbKkDn/6L8H+SVSWFYzogwBE3n04E0Mz5xYdtAu6tjeGWC/CUyXcpSgDRRyA8wSme8bQUAIpO0JjexOeOfXHaBJy9jrUNcXBp6F8POxuayU4MdCmunWj5Aw7thw8ZO0GzA1I+3AOlBk2qaQihht9Mb1/xA8UgwLPhMqJFOzwsd8UzOqvy76Qq23iVcVgh0ARY8Rcl0T82dvonj/B/755wJuGalia5epfjjS6o8hs0KNnb6aMDohqYpDquUCqIyQQL/dj9kzGkBRQHBZAfzrdYTjOZvfncpFgcuRlzl5cbtZWJwZNrww+vQ1gH2SmMP2qsRTy78Y=
  - secure: YHltZT0MNrgZoYEdiqiECAlOq3Q0ggrukDt4tb24Q1O+PU7yW43+653dN1pmiMTDU4tDZmSBoD7aKRq2yl5Q5l41mO5rTn8QEPykC0B8HGOu7vZZFY6FlxSZvqlLifyi5bdtaZdwicnlOQVzrC1WyUI0YCFjKQZAbXVN5xEIYIpcAqB0ndj1VGdHJxSR3tjIYtzqtmUB57XhsKLCt6FhSXn6BO6OEsfz8PY3zCVvOh5y1kez7nY8PxGYXtb7rdUgUSBgSPND60P+vFhGFEBXTJFldecp1A1euaEeyIkyAG+Qx1dHcOPSBX6nkufXsJm1lin4t0pDiJSHzeNAJwuuYYArMQn24RYlOYsIgfzf5/fXtUx5VtjXvyYjiz1mKKRnXTKF8Irj1hCklaLvg6pcn0qFn9H3tUKB0DL9iouXmQOBqMKFK5CsuDFf8N/R4Um0Qh8FwvaNj6ctsMIPrqRHyHUxu5ASslQMqgu+reOPlP/iViHdgRTotEstk7vQF53KBA9MJUJtKft4x/EPijUhu9Z8gz1f+bHEUycK2reIAwJXp2c/HunVFGZrapxoF2YddV700onVzXsSUP7eWMyZ/vFm2XTfOCe1oO54/qyV/j5zUWcrWWGx8FikkaPFhVC54n9+kVtjmFR0i5KpxUnAtGB8pExsq5Mj157iFFi09zE=
  - secure: WypA3jXVpCs54Q/MmIiwZkUMq1h5OEas/oY6esXSxsSbIQxyvVyJwIx4kWXW0+/GR8WYrvG8/Tegmzt2Tdn3zY0qqDK7xsYdngOrzf7Z+L0KOrWyQsa8QC23cNh/BriMpRAGqnT3VngQXUzl0n7pRlQDn3qO6TSCrCWWJHYFvbMxdJaATXG7dMLmOxRN5NQbXr0VbvErkdzYGYr2g+IKNqnL/mEsTDoPxYcN8ZhOkbPkA6Alkxy1tquyLxPACdyAq2JiD1IFq2U0ugRyfHhu4aJgOsO4hgXQmy+XmwMwTmsFGR5scFzT2lc83B/QCpdjnj+Kir2x6Fc+vi6EBlNCGWPWePJEjDTZUHpEft2CLnix/gT1Ssjpbp3S/3qaDV6O5fwah88V4OS0qgc8U3hJLhkX/Rno3ZT47YDOPJQKIjSkhYoPfJHdtZnVFXVFN/SLyPi9EDLKtaS1jUkHqimIknYzXYKxIcP4F2HbBYazoWTa+rx72eX4V4ueAER6hRgReEnOVbdoeh0/1G984wSw2hi/tQAkrATc3489LPrKoANrLFRAZ92xTwkdKz4c2ggVHTpN/tsiLk3he+YxnQZcEgQYQy2OJI7BuhGU180IzzwaGZQApX0oKZZT2z/h+H3O2/fzB8pc4THYJycoKTPXOfUsj15WuNm4MnNaSdbTvmw=
  - secure: f4Sjx80bFcePVOTdE2nW3JDvRznj3lMTjJnXJzSBsDfnUczTAJR6ZetK+VWl6o6M+P2Arq7scQFjNyR21ukr3/IJUGdz/hq6rKeRoifsd/4D9MdD+mtdyO9Bejy5VBSbht/5BbsAtagDPCj3LCBnsMtmzuUKCwLEmPEX5tRGjeg8DLbc3DnGls1HNw8amV879LjHMoIEw75fD9WWlDQCW2fX1k1i7yOUzauY4p2i0B/e+aFfoW/0zMKuEs16VQXPbsxyezcHmg++0W/gBHhkLSk+XL/WGZg0F1HpT3AFTbiJ8k6pJciXP/DaGFAY02K7dG1igkWYjGKokXNML9NVB9KHkwL5iZ5rR8LoKmJuYfyYQCaFkO39jwXeGV4vNTNaWJg6PjJlud0yibW/9IbDhOgAaXJSUQoIb5kfWs0OX4NSP2B8JHfqYFWEMSGTLA+k0o07ajYrwpGi5TbZgBUocrd8KUVaehTRm1mXmTiprP2by4izxSJwgSgjE68rEcuV14ZzqvRNK3bAiImQO8DewEv79BIeIMhBlZEgMBQj4eS8vqS1RSy9Yy/Z6HFRPpyl8n41d4ZZwyq1PTxzcaDQnxtzpFNK1FfYGwsOxuc8tvlnyV2ugOZSDd3KEvSIVuu1IQbqy5/qhxlB4uKDLpC1uz5OsoMCxygDjN2x3Qu2u5A=
  - secure: h/tHauoDSJyQcZEqa+8sL+r0mgJYirBQWGnC6f3haUlsdSLNNoQKImg5QBFSheZr7bYG8E4CevlMjERV/KV+hAZ1zXBXRe+WG56pF7mWDsTqUM7ZMicf1N0Rjg5hyTSNbUrM2dth1eRzY2mvt3by+LQoIkocWe0hPYMXAqxbQRYdx9ydSQ++OoPDywT8spPGtOp8Bhn/apzfYxCDmsG8HT9MSQ4KJ8/yq9ty104N4cEgF2lwK8yVT20XY0hYRTR8V+ucCLC2Yv7+/OdzPPToqpwXYvcMXUmJIvYJr93zi6MAojUm4q+QOP9YOkdalkBdJrEe5lFAtjQsuWWvYNIxYK3qSPrFzfijpbRXwgHvRsVzPbzqsIcXpdGsra5yytcvyp0FNKATQsTa0K61ilsRKGnxKb6u0Pe2Od/unhZXVh2cghy+K9kZ2Tq65GdbcWgvC51gj04ZQO0t0qftoqY61NBTlsecsWktsSFQRastFfnuHTKjg/RSPRXXCgpjvKjgabwPMA0CYiTRA2N+6DN4CXaxDWlMcqguyVnErZIFaAJnSgkaWB0d6GCJijf9+4eWaQ12cNnrV1kK0y8ToLWJgksZfvhR45H3kOcIzXFSxJLxRtVLa/TXtfSApGegUz9ckkaHxChNWAuV9umKSJqUALLCfAwbfIeuCffVylZCxv4=
  - secure: fxzpPZ9AW2CdU9+isdBGplxnQZBReNZWaj9jWtYbVkMxLVCfENLQQl20f5FB6OOXKCQePo4c4dXFwB+aa3xiHVP91JDFm12d9cyz87MIbFVi3oBuob8rJG7NopJjQy9Y1Z2z/+Er0ScvthSTEOGnY8G/wyRMwJB12/NayaDpn+xKQYQgZbuXhHFexPO/pRiolNoXxaLb8ZHMqz7v/OtVpQ45p5sxontO9BA6fUUKF1704qk3hMGBzQYOfKhQ7lfJXV7O0KziChUIhDlyFEW+67gI9kuD1KqRjzut857gSoHc/KNjlX+ZKVouqKmarPJ7TSjEmcUuNJPesyvLHBmU07DtiSCOPlFPH1Hy/NL4CF0NAAo9iFyQnaS/LIpD005MvnlC5MhYsa5Sw/BOKcnWVoslqi0csiuaqv6ZJCKJEATfPCuU5rzIq7/jLx6ultI8zOGjH1Eii1+g4xItEh+c6MrhE90sw+Rz9ZFQY87Qt16ZpNGx/r0TX72bACYxHffFH2755/7Jc5f+6plGdMMQYjgkFVk8q0z3vYJjKmRx9y3zK3WJBmRvopC/PdwHVIyYQm+uRuo5oru8GBiEcCdsZ5zX9MAFAiF/VTsgqX037AP1mKle/R9tMuCRfl2GCLCeMJ70CpSOtWzbGQ1+NKLjADDeUgzuSUJMubKynns8+EA=
install: "/bin/true"
script:
- if [ "$TRAVIS_PULL_REQUEST" != "false" ]; then bash ./travis-build-pr.sh; fi
- if [ "$TRAVIS_PULL_REQUEST" = "false" ]; then bash ./travis-build.sh; fi
before_cache:
  - rm -f  $HOME/.gradle/caches/modules-2/modules-2.lock
  - rm -fr $HOME/.gradle/caches/*/plugin-resolution/
cache:
  directories:
    - $HOME/.gradle/caches/
    - $HOME/.gradle/wrapper/
after_deploy:
- "./gradlew sdkMajorRelease"
deploy:
  provider: releases
  api_key:
    secure: DGa/P6NIzjUrlBCwy7K6/Sr42lvwxkOGcDhMj5IU476ZCP38cbf8ibhNPuMUZ+CluEPJtbOouVZZL2C3kGYJSXsToFOw94up01izRys26Ej/l3A7r4Am6FToZmBqrK07nbGI92UXdV+KuQP97iKWDhE406y5DjoBUBlTMNsg2zHhHbUjF8jcCa2Sj2WA1xMPh9QS/Llh7dC0lG9JLzzJnvSlhRJXf6fa7fST+jeAc2nxIxtuNn6+YnXIGfLr8jt4MBHka5aIkg0htjeVZyNrfRl54BX5npVo7dx3W/H5XP9ZEA89tXxe5ZZEt3wgmAZLlcFnoPpebwYEXT0q/oLSXpUv9lbhKX4HaSwIdSoiRByPN8LnjPXZA5UmsYeiqPCqBPeS7pMEu3bsibSnpunPSJbwDF+egVX5pPCFUyZXva7vOCr4uQRZQMQNRo5u3bh7TTaFhjpEAtnPpVvwUYEOzKqoU/umOmJMyHG53Ut3R79OP9U0A18VTtZJ5Usi2fPqo8nTdn+Sli7rOnyDfjnPLUriW+5jFfMINcbzSPhTJAjsazdvWnox06K0vNYldrCkkkQ+BjOm+YmY6ANg4q3Ap3+65osEeL0G34bstiEBcQCw0wbwKMLgYSHMpBf5XZQL7MsppZLJQv5HRinKJQeYSTtSM3pKWdQVo5cGtBxQiPY=
  file: cli/build/distributions/micronaut-${TRAVIS_TAG:1}.zip
  skip_cleanup: true
  on:
    repo: micronaut-projects/micronaut-core
    tags: true
    all_branches: true
