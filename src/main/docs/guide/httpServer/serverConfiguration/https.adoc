Micronaut supports HTTPS out of the box. By default HTTPS is disabled and all requests are served using HTTP. To enable
HTTPS support, modify your configuration. For example with `application.yml`:

.HTTPS Configuration Example
[source,yaml]
----
micronaut:
    ssl:
        enabled: true
        buildSelfSigned: true # <1>
----
<1> Micronaut will create a self-signed certificate.

TIP: By default Micronaut with HTTPS support starts on port `8443` but you can change the port the property
 `micronaut.ssl.port`.

WARNING: Keep in mind that this configuration will generate a warning on the browser.

image::https-warning.jpg[]


== Using a valid x509 certificate

It is also possible to configure Micronaut to use an existing valid x509 certificate, for example one created with
https://letsencrypt.org/[Let's Encrypt]. You will need the `server.crt` and `server.key` files and convert them to a
 PKCS #12 file.

[source,bash]
----
$ openssl pkcs12 -export \
                 -in server.crt \ # <1>
                 -inkey server.key \ # <2>
                 -out server.p12 \ # <3>
                 -name someAlias \ <4>
                 -chain -CAfile ca.crt -caname root
----
<1> The original `server.crt` file
<2> The original `server.key` file
<3> The `server.p12` file that will be created
<4> The alias for the certificate

During the creation of the `server.p12` file it is necessary to define a password that will be required later when using
the certificate in Micronaut.

Now modify your configuration:

.HTTPS Configuration Example
[source,yaml]
----
micronaut:
    ssl:
        enabled: true
        keyStore:
            path: classpath:server.p12 # <1>
            password: mypassword # <2>
            type: PKCS12
----
<1> The `p12` file created. It can also be referenced as `file:/path/to/the/file`
<2> The password defined during the export

With this configuration if we start Micronaut and connect to `https://localhost:8443` we still see the warning on the
browser but if we inspect the certificate we can check that it's the one generated by Let's Encrypt.

image::https-certificate.jpg[]


Finally we can test that the certificate is valid for the browser just by adding an alias to the domain in `/etc/hosts` file:

[source,bash]
----
$ cat /etc/hosts
...
127.0.0.1   my-domain.org
...
----

Now we can connect to `https://my-domain.org:8443`:

image::https-valid-certificate.jpg[]


== Using Java Keystore (JKS)

It is not recommended using this type of certificate because it is a proprietary format and it's better to use a PKCS12
format. In any case Micronaut also supports it.

Convert the `p12` certificate to a JKS one:

[source,bash]
----
$ keytool -importkeystore \
          -deststorepass newPassword -destkeypass newPassword \ # <1>
          -destkeystore server.keystore \ # <2>
          -srckeystore server.p12 -srcstoretype PKCS12 -srcstorepass mypassword \ # <3>
          -alias someAlias # <4>
----
<1> It is necessary to define a the password for the keystore
<2> The file that will be created
<3> The PKCS12 file created before and the password defined during the creation
<4> The alias used before

WARNING: If either `srcstorepass` or `alias` are not the same as defined in the `p12` file, the conversion will fail.


Now modify your configuration:

.HTTPS Configuration Example
[source,yaml]
----
micronaut:
    ssl:
        enabled: true
        keyStore:
            path: classpath:server.keystore
            password: newPassword
            type: JKS
----

Start Micronaut and the application is running on `https://localhost:8443` using the certificate in the keystore.
