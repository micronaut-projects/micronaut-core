plugins {
    id "io.micronaut.build.internal.convention-library"
    alias libs.plugins.managed.kotlin.jvm
}

dependencies {
    annotationProcessor project(":inject-java")
    annotationProcessor project(":graal")
    api project(":context")
    api project(":core-reactive")
    api(project(":context-propagation"))
    implementation libs.managed.reactor
    compileOnly libs.managed.kotlinx.coroutines.core
    compileOnly libs.managed.kotlinx.coroutines.reactor

    compileOnly libs.managed.jackson.annotations

    testCompileOnly project(":inject-groovy")
    testAnnotationProcessor project(":inject-java")
    testImplementation project(":jackson-databind")
    testImplementation project(":inject")
    testImplementation project(":runtime")
    testImplementation(libs.logback.classic)
    testImplementation(libs.jazzer.junit)
    testImplementation(libs.junit.jupiter.params)
    testImplementation(libs.micronaut.test.junit5) {
        exclude group: 'io.micronaut'
    }
}

tasks.named("compileKotlin") {
    kotlinOptions.jvmTarget = "17"
}

//compileJava.options.fork = true
//compileJava.options.forkOptions.jvmArgs = ['-Xdebug', '-Xrunjdwp:transport=dt_socket,server=y,suspend=y,address=5005']

spotless {
    java {
        targetExclude '**/io/micronaut/http/uri/QueryStringDecoder.java'
    }
}
